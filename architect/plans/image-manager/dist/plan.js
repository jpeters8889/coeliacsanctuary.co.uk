!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";t.a={props:{name:String,value:String|Array|Object,metas:Array|Object,id:Number,listener:{type:String,default:"prepare-form-data"},emitter:{type:String,default:"form-field-change"}},mounted(){void 0!==this.value&&(this.actualValue=this.value),this.bootstrapListeners(),this.debouncedEvents=window._.debounce(this.dispatchEvents,500)},data:()=>({actualValue:"",emitterValue:null,setEmitterValue:!0}),methods:{getFormData(){return{name:this.name,value:this.actualValue}},dispatchEvents(){this.emitterValue&&Architect.$emit(this.name+"-changed",this.emitterValue)},bootstrapListeners(){Architect.$on(this.listener,()=>{Architect.$emit(this.emitter,this.getFormData())}),Object.keys(this.metas.listeners).forEach(e=>{let t=this.metas.listeners[e];"string"==typeof t&&Architect.$on(t+"-"+e,n=>{Architect.request().post("/listener",{blueprint:this.$route.params.blueprint,event:t+"-"+e,column:this.name,value:JSON.stringify(n)}).then(e=>{this.actualValue=e.data}).catch(e=>{Architect.$emit(e.response.data.message)})})})}},watch:{emitterValue:function(e){""!==e&&this.debouncedEvents()},actualValue:function(e){this.setEmitterValue&&(this.emitterValue=e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);n.d(t,"IsAFormField",(function(){return r.a}))}])},e.exports=r()},function(e,t,n){n(2),e.exports=n(3)},function(e,t,n){"use strict";n.r(t);function r(e,t,n,r,i,s,a,o){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),s&&(l._scopeId="data-v-"+s),a?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=c):i&&(c=o?function(){i.call(this,this.$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var f=l.beforeCreate;l.beforeCreate=f?[].concat(f,c):[c]}return{exports:e,options:l}}var i=r({},(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null).exports;function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=r({mixins:[n(0).IsAFormField],data:function(){return{images:[],selectedImages:{},hasImages:{},showModal:!1,insertType:"left",insertDescription:"",insertImage:""}},mounted:function(){var e=this;Architect.$on("modal-close",(function(){e.showModal=!1})),Object.keys(this.metas.buttons).forEach((function(t){!0===e.metas.buttons[t]&&"insert"===!t&&(e.$set(e.selectedImages,t,""),e.$set(e.hasImages,t,!1))})),this.$set(this.selectedImages,"article",[]),this.value&&Object.keys(this.value).forEach((function(t){var n=e.pushImage(),r=e.value[t];e.displayImage(r,n),r.type&&r.type.split(",").forEach((function(t){"article"!==t?e.handleImageButtonClick(t,r):e.$set(e.selectedImages.article,e.selectedImages.article.length,r.filename)}))}))},methods:{getFormData:function(){return{name:this.name,value:JSON.stringify(this.selectedImages)}},uploadImage:function(){this.$refs.fileTrigger.click()},processImages:function(){for(var e=this,t=this.$refs.fileTrigger.files,n=new FormData,r=[],i=0;i<t.length;i++)n.append("files[".concat(i,"]"),t[i]),r.push(this.pushImage());window.Architect.request().post("/external/image-manager/upload",n,{"Content-Type":"multipart/form-data"}).then((function(t){t.data.forEach((function(t,n){e.displayImage(t,r[n])}))}))},pushImage:function(){var e=this.images.length;return this.$set(this.images,e,{processing:!0}),e},displayImage:function(e,t){this.$set(this.images,t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({processing:!1},e))},handleImageButtonClick:function(e,t){if("insert"===e)return this.showModal=!this.showModal,void(this.insertImage=t.filename);var n=t.filename,r=!0;this.selectedImages[e]===t.filename&&(n="",r=!1),this.$set(this.selectedImages,e,n),this.$set(this.hasImages,e,r)},generateButtonClass:function(e,t){return this.selectedImages[e]===t.filename?"bg-green-500 text-white":!0===this.hasImages[e]?"bg-gray-200 text-gray-500":"bg-blue-500 text-white"},generateButtonIcon:function(e){switch(e){case"social":return["fab","facebook-square"];case"header":return["fas","home"];case"square":return["fas","crop"];case"insert":return["fas","paste"]}},canDisplayButton:function(e,t){switch(e){case"social":case"header":return t.width>=1200;case"square":return t.width===t.height}return!0},generateButtonTooltip:function(e){switch(e){case"social":return"Set as Social Image";case"header":return"Set as Header Image";case"square":return"Set as Square Image";case"insert":return"Insert image into body"}},processImageInsert:function(){var e='<article-image src="'.concat(this.insertImage,'" title="').concat(this.insertDescription,'" position="').concat(this.insertType,'"></article-image>');window.Architect.$emit(this.metas.insertImageIntoField+"-append",e),this.$set(this.selectedImages.article,this.selectedImages.article.length,this.insertImage),this.closeModal()},closeModal:function(){this.showModal=!1,this.insertType="left",this.insertDescription="",this.insertImage=""}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"form-control"},[n("input",{ref:"fileTrigger",staticClass:"hidden",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:e.processImages}}),e._v(" "),n("ul",{staticClass:"flex flex-wrap align-start"},[e._l(e.images,(function(t){return n("li",{staticClass:"mr-2 mb-2 border-1 border-blue-500 rounded w-imageManager relative flex justify-center items-center text-6xl text-blue-500 cursor-pointer max-h-imageManager",class:e.images.length>0?"initial":"hidden"},[t.processing?n("div",[n("font-awesome-icon",{attrs:{icon:["fas","circle-notch"],spin:""}})],1):n("div",[n("img",{attrs:{src:"/"+t.path,alt:""}}),e._v(" "),n("div",{staticClass:"absolute left-0 bottom-0 m-1 flex flex-wrap"},e._l(e.metas.buttons,(function(r,i){return r&&e.canDisplayButton(i,t)?n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.generateButtonTooltip(i),expression:"generateButtonTooltip(button)",modifiers:{bottom:!0}}],staticClass:"rounded text-sm w-auto cursor-pointer mr-1 p-1",class:e.generateButtonClass(i,t),on:{click:function(n){return e.handleImageButtonClick(i,t)}}},[n("font-awesome-icon",{attrs:{icon:e.generateButtonIcon(i)}})],1):e._e()})),0)])])})),e._v(" "),n("li",{staticClass:"mr-2 mb-2 border-1 border-blue-500 rounded min-w-imageManager relative flex justify-center items-center text-6xl text-blue-500 cursor-pointer h-imageManager",on:{click:e.uploadImage}},[n("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1)],2)]),e._v(" "),e.showModal?n("portal",{attrs:{to:"modal"}},[n("modal",{attrs:{title:"Insert Image"}},[n("div",{staticClass:"w-full flex flex-col justify-center items-center leading-none"},[n("div",{staticClass:"w-full py-3"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.insertType,expression:"insertType"}],staticClass:"form-control form-control-input w-full",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.insertType=t.target.multiple?n:n[0]}}},[n("option",{attrs:{disabled:""}},[e._v("Image Type")]),e._v(" "),n("option",{attrs:{value:"left"}},[e._v("Left Align")]),e._v(" "),n("option",{attrs:{value:"right"}},[e._v("Right Align")]),e._v(" "),n("option",{attrs:{value:"fullwidth"}},[e._v("Full Width")])])]),e._v(" "),n("div",{staticClass:"w-full py-3"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.insertDescription,expression:"insertDescription"}],staticClass:"form-control form-control-input w-full",attrs:{placeholder:"Description"},domProps:{value:e.insertDescription},on:{input:function(t){t.target.composing||(e.insertDescription=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"w-full py-3 flex justify-center"},[n("button",{staticClass:"button-primary button px-4 py-1 rounded",on:{click:function(t){return t.preventDefault(),e.processImageInsert()}}},[e._v("\n                        Insert Image\n                    ")])])])])],1):e._e()],1)}),[],!1,null,null,null).exports;Architect.onBoot((function(e){e.component("image-manager-list",i),e.component("image-manager-form",o)}))},function(e,t){}]);